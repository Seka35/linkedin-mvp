# üöÄ PROTOTYPE MVP - LINKEDIN AUTOMATION

## üìã PLAN D'EX√âCUTION PAR PHASES

**Objectif :** Cr√©er un prototype simple, gratuit, fonctionnel en Python avec interface web basique pour automatiser LinkedIn (scraping + connexions + commentaires + DMs).

---

# PHASE 2 : BASE DE DONN√âES SQLITE

## Objectif
Cr√©er une base de donn√©es SQLite simple pour stocker les prospects et les actions.

## Instructions pour l'IA

### 2.1 Cr√©er `database/models.py` avec les mod√®les suivants :

```python
"""
Mod√®les de base de donn√©es SQLAlchemy.
3 tables principales: Prospect, Campaign, Action
"""

from sqlalchemy import Column, Integer, String, DateTime, Boolean, Text, ForeignKey
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import relationship
from datetime import datetime

Base = declarative_base()

class Prospect(Base):
    """Table des prospects LinkedIn"""
    __tablename__ = 'prospects'
    
    id = Column(Integer, primary_key=True)
    linkedin_url = Column(String, unique=True, nullable=False)
    full_name = Column(String)
    headline = Column(String)
    company = Column(String)
    location = Column(String)
    profile_picture = Column(String)
    
    # Status du prospect
    status = Column(String, default='new')  # new, connected, messaged, replied
    
    # M√©tadonn√©es
    source = Column(String)  # google_serp, apify, manual
    added_at = Column(DateTime, default=datetime.utcnow)
    last_action_at = Column(DateTime)
    
    # Relations
    actions = relationship("Action", back_populates="prospect")

class Campaign(Base):
    """Table des campagnes de prospection"""
    __tablename__ = 'campaigns'
    
    id = Column(Integer, primary_key=True)
    name = Column(String, nullable=False)
    search_query = Column(String)  # Google dork ou crit√®res Apify
    
    # Templates de messages
    connection_message = Column(Text)
    first_message = Column(Text)
    
    # Configuration
    daily_limit = Column(Integer, default=10)
    status = Column(String, default='active')  # active, paused, completed
    
    # M√©tadonn√©es
    created_at = Column(DateTime, default=datetime.utcnow)
    
    # Relations
    actions = relationship("Action", back_populates="campaign")

class Action(Base):
    """Table des actions LinkedIn effectu√©es"""
    __tablename__ = 'actions'
    
    id = Column(Integer, primary_key=True)
    prospect_id = Column(Integer, ForeignKey('prospects.id'))
    campaign_id = Column(Integer, ForeignKey('campaigns.id'), nullable=True)
    
    # Type d'action
    action_type = Column(String)  # visit, connect, comment, message
    
    # D√©tails
    message_sent = Column(Text)
    comment_sent = Column(Text)
    post_url = Column(String)  # Pour les commentaires
    
    # R√©sultat
    status = Column(String)  # pending, success, failed
    error_message = Column(Text)
    
    # M√©tadonn√©es
    executed_at = Column(DateTime, default=datetime.utcnow)
    
    # Relations
    prospect = relationship("Prospect", back_populates="actions")
    campaign = relationship("Campaign", back_populates="actions")
```

### 2.2 Cr√©er `database/db.py` :

```python
"""
Gestion de la connexion √† la base de donn√©es SQLite.
"""

from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker, scoped_session
from .models import Base
import os

# Chemin vers la DB
DB_PATH = os.path.join(os.path.dirname(__file__), '..', 'data', 'prospects.db')

# Cr√©er le dossier data si inexistant
os.makedirs(os.path.dirname(DB_PATH), exist_ok=True)

# Cr√©er engine SQLite
engine = create_engine(f'sqlite:///{DB_PATH}', echo=False)

# Session factory
SessionLocal = scoped_session(sessionmaker(bind=engine))

def init_db():
    """Initialiser la base de donn√©es (cr√©er tables)"""
    Base.metadata.create_all(bind=engine)
    print("‚úÖ Base de donn√©es initialis√©e")

def get_db():
    """Obtenir une session de base de donn√©es"""
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

### 2.3 Cr√©er `database/__init__.py` :

```python
from .db import init_db, get_db, SessionLocal
from .models import Prospect, Campaign, Action

__all__ = ['init_db', 'get_db', 'SessionLocal', 'Prospect', 'Campaign', 'Action']
```

## Livrables de Phase 2
- [ ] Mod√®les SQLAlchemy cr√©√©s (Prospect, Campaign, Action)
- [ ] Connexion SQLite configur√©e
- [ ] Fonction init_db() pour cr√©er les tables
- [ ] Base de donn√©es peut √™tre cr√©√©e et accessible